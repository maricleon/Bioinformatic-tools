# Extract and process only rows with CTX genes
awk -F'\t' '$7 ~ /CTX/ {print $1, $3, $4, $5, $7}' "prekmurje_amr.txt" | while read -r sample contig start end gene; do
    fasta="$sample"
    [[ -f "$fasta" ]] || continue
    out="${sample%.*}_ctx_genes.fasta"  # Strip .fasta from output name
    seq=$(samtools faidx "$fasta" "${contig}:${start}-${end}")
    echo ">${sample%.*}_${contig}_${start}_${end}_${gene}" >> "$out"
    echo "$seq" | tail -n +2 >> "$out"
done
